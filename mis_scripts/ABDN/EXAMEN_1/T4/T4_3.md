Aqu铆 tienes la gu铆a detallada para resolver la **Pr谩ctica 4.3. Redo Logs**, dise帽ada para entender c贸mo funcionan las transacciones, la consistencia de los datos y el aislamiento en una base de datos relacional (MySQL).

# Gu铆a Paso a Paso: Pr谩ctica 4.3 - Redo Logs y Aislamiento de Transacciones

Esta pr谩ctica demuestra que los cambios realizados en una base de datos no son visibles para otros usuarios hasta que se confirman (`COMMIT`), aunque internamente ya se est茅n registrando en los logs de transacciones (Redo Logs).

---

###  Requisitos Previos

Necesitas una instancia RDS MySQL funcionando. Puedes reutilizar la instancia "cutre" o b谩sica creada en las pr谩cticas anteriores (4.1 o 4.2).

Necesitar谩s abrir **dos terminales** diferentes (o dos pesta帽as de CloudShell) para simular dos usuarios distintos conectados a la misma base de datos.

---

### Parte 1: Preparaci贸n del Entorno (Sesi贸n 1)

Abre tu primera terminal (**Sesi贸n A**) y con茅ctate a tu base de datos:
`mysql -h tu-endpoint-rds -u admin -p`

**Paso 1: Desactivar Autocommit**
Por defecto, MySQL guarda cada comando inmediatamente. Vamos a desactivarlo para controlar nosotros la transacci贸n manualmente.

```sql
SELECT @@autocommit;
SET autocommit = 0;

```

**Paso 2: Crear Datos de Prueba**
Vamos a crear una base de datos, una tabla de "cuentas" y un saldo inicial de 1000.

```sql
CREATE DATABASE redo_test;
USE redo_test;

CREATE TABLE cuentas (
    id INT PRIMARY KEY,
    saldo INT
) ENGINE=InnoDB;

INSERT INTO cuentas VALUES (1, 1000);
COMMIT;

```

*(Es muy importante ejecutar el `COMMIT` final aqu铆 para que el saldo de 1000 se guarde permanentemente en el disco)* .

---

### Parte 2: La Transacci贸n Incompleta (Sesi贸n 1)

Seguimos en la **Sesi贸n A**. Vamos a simular una operaci贸n bancaria (restar dinero) pero dej谩ndola "a medias" (sin confirmar).

**Paso 3: Modificar el saldo**

```sql
START TRANSACTION;

UPDATE cuentas 
SET saldo = saldo - 200 
WHERE id = 1;

```

**Paso 4: Verificar lo que ve el usuario actual**
Ejecuta un select en esta misma terminal:

```sql
SELECT * FROM cuentas WHERE id = 1;

```

**驴Qu茅 ocurre?** Ver谩s que el saldo es **800**.
*Raz贸n:* Tu sesi贸n ve sus propios cambios, aunque no est茅n guardados en disco definitivamente, porque los lee de su propia memoria de trabajo.

 **CAPTURA 1 (Sesi贸n A):**
Haz una captura de esta terminal donde se vea el `UPDATE` realizado y el `SELECT` mostrando el saldo de **800**.

---

### Parte 3: Verificaci贸n de Aislamiento (Sesi贸n 2)

Ahora vamos a ver qu茅 ocurre "fuera" de tu sesi贸n. Abre una **segunda terminal** o pesta帽a (**Sesi贸n B**) y con茅ctate a la misma base de datos.

**Paso 5: Consultar desde fuera**

```sql
USE redo_test;
SELECT * FROM cuentas WHERE id = 1;

```

**驴Qu茅 ocurre?** Ver谩s que el saldo sigue siendo **1000**.
*Raz贸n:* Como la Sesi贸n A no ha hecho `COMMIT`, la base de datos protege a la Sesi贸n B de leer datos "sucios" o incompletos. El cambio real (los 800) est谩 pendiente en los **Redo Logs** y en el buffer de memoria, pero no es "oficial" para el resto del mundo.

 **CAPTURA 2 (Sesi贸n B):**
Haz una captura de esta segunda terminal donde se vea el `SELECT` mostrando el saldo de **1000**.

---

###  Explicaci贸n Te贸rica (Para tu informe)

El documento pide explicar qu茅 est谩 ocurriendo y qu茅 pintan los **Redo Logs** en esto:

1. **驴Qu茅 valores tenemos?**
* En la sesi贸n 1: **800** (ve su propio cambio).
* En la sesi贸n 2: **1000** (ve la versi贸n confirmada anterior).


2. **驴Qu茅 ocurre? (Aislamiento):**
* El motor InnoDB utiliza un mecanismo llamado MVCC (Control de Concurrencia Multiversi贸n). Mientras no hagas `COMMIT`, los cambios existen en un estado intermedio.


3. **Papel del Redo Log:**
* Cuando ejecutas el `UPDATE` en la Sesi贸n 1, el cambio **se escribe en el buffer del Redo Log** (memoria) inmediatamente. Esto asegura la *Durabilidad* (la 'D' de ACID): si la base de datos se apagara de golpe justo despu茅s de hacer commit, usar铆a el Redo Log para recuperar ese dato.
* Sin embargo, hasta que no haces `COMMIT`, ese cambio no se hace visible para otras transacciones (Aislamiento).



###  Resumen de Capturas para la Entrega

Para verificar que has realizado la pr谩ctica correctamente, incluye en tu documento:

1. **Captura de la Sesi贸n 1:** Mostrando que has desactivado el autocommit, realizado el `UPDATE` a -200 y que el `SELECT` devuelve **800**.
2. **Captura de la Sesi贸n 2:** Mostrando que, al mismo tiempo, al hacer un `SELECT` el saldo sigue siendo **1000**.

*(Opcional: Si quieres completar el ciclo, vuelve a la Sesi贸n 1, escribe `COMMIT;`, y luego comprueba en la Sesi贸n 2 c贸mo el valor cambia m谩gicamente a 800).*
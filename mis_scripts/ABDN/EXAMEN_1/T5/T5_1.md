Esta gu铆a detalla paso a paso c贸mo realizar la pr谩ctica de **"Simulaci贸n de actualizaciones de mantenimiento con Blue/Green Deployment"** en Amazon RDS, basada en el documento que has proporcionado.

La pr谩ctica se divide en tres partes principales:
1.  Creaci贸n de la base de datos.
2.  Despliegue Blue/Green (Azul/Verde).
3.  Uso de la AWS CLI para mantenimiento.

---

### **Parte I: Crear la instancia de base de datos**

El objetivo es tener una base de datos "antigua" para luego actualizarla.

1.  **Inicia sesi贸n** en tu consola de AWS.
2.  Ve al servicio **RDS**.
3.  Haz clic en el bot贸n naranja **Create database** (Crear base de datos).
4.  Selecciona **Standard create**.
5.  **Motor:** Selecciona **MySQL**.
6.  **Versi贸n:** Es importante seleccionar una versi贸n espec铆fica antigua. El PDF indica la **8.0.40**.
    *   *Nota:* Si esa versi贸n exacta no est谩 disponible, elige la m谩s cercana anterior a la actual (ej. 8.0.35 o 8.0.39) para poder actualizarla despu茅s.
7.  **Plantilla:** Puedes usar "Dev/Test" o "Free tier" para minimizar costes.
8.  **Configuraci贸n:**
    *   **Identificador:** `p5-1-mantenimiento` (o el nombre que prefieras).
    *   Define una contrase帽a maestra y recu茅rdala.
9.  Deja el resto de opciones por defecto y haz clic en **Create database**.
10. Espera unos minutos hasta que el estado cambie a **Available** (Disponible).

---

### **Parte II: Simulaci贸n Blue/Green Deployment**

Aqu铆 es donde realizas la actualizaci贸n sin detener la base de datos original.

1.  En el panel de RDS, ve a **Databases** y selecciona tu instancia (`p5-1-mantenimiento`).
2.  Ve a la pesta帽a **Maintenance & backups**.
    *   *Acci贸n:* Observa si hay actualizaciones pendientes.
    *    **CAPTURA 1:** Toma una captura de esta secci贸n "Maintenance & backups", aunque diga que no hay actualizaciones pendientes o muestre alguna. (Referencia PDF Pag 1, paso 3).
3.  Haz clic en el bot贸n **Modify** (Modificar) arriba a la derecha.
4.  Busca la secci贸n **DB Engine Version**. Cambia la versi贸n a una superior, por ejemplo **8.0.44** (o la que te sugiera el PDF).
5.  Al hacerlo, aparecer谩 un aviso sugiriendo **Blue/Green Deployment**.
6.  **IMPORTANTE:** No guardes los cambios abajo del todo. En su lugar, busca el bot贸n o enlace dentro del aviso que dice **Create Blue/Green Deployment** y haz clic ah铆.
7.  **Configuraci贸n del despliegue:**
    *   Identificador: Deja el sugerido (suele ser `bg-deployment-1`).
    *   Versi贸n del motor: El PDF sugiere seleccionar la **8.0.43** (o la 煤ltima recomendada que te aparezca).
8.  Haz clic en **Create Blue/Green Deployment**.
9.  Volver谩s a la lista de bases de datos. Ver谩s que se est谩 creando un cl煤ster con dos entornos:
    *   **Blue (Azul):** Tu base de datos original (Producci贸n).
    *   **Green (Verde):** La nueva base de datos que se est谩 actualizando (Staging).
10. Espera unos 15-20 minutos hasta que el estado sea **Available**.
    *    **CAPTURA 2:** Toma una captura del listado de instancias donde se vea la estructura de 谩rbol del despliegue Blue/Green (la original y la copia verde debajo). (Referencia PDF Pag 2, paso 11).

#### **Intento de Conmutaci贸n (Switch Over)**
11. Selecciona la fila que dice **Blue/Green Deployment** (el agrupador, no las instancias individuales).
12. Ve al men煤 **Actions** -> **Switch over** (Conmutar).
13. Configura el **Timeout** a **30 minutes**.
14. Haz clic en **Switch over**.
    *   *Resultado esperado:* Seg煤n el PDF (Pag 3, paso 20), es muy probable que **no tengas permisos** (Access Denied) si est谩s usando una cuenta de estudiante (AWS Academy/Learner Lab).
    *    **CAPTURA OPCIONAL:** Si te sale el error de permisos, captura esa pantalla como evidencia de que llegaste a este paso.
    *   *Nota te贸rica:* Si funcionara, la base de datos "Verde" pasar铆a a ser la principal y la "Azul" se renombrar铆a a `-old`.

#### **Eliminaci贸n del entorno**
15. Selecciona el despliegue Blue/Green.
16. Ve a **Actions** -> **Delete**.
17. Marca la casilla **Delete the green databases** (Borrar las bases de datos verdes).
18. Escribe `delete me` en el cuadro de confirmaci贸n y elimina.
19. Ahora solo te quedar谩 tu base de datos original (`p5-1-mantenimiento`).

---

### **Parte III: Uso de la API (AWS CLI)**

Esta parte simula el mantenimiento usando comandos desde la terminal.

1.  Abre la terminal de tu ordenador (si tienes AWS CLI configurado) o usa **CloudShell** en la consola de AWS (icono de terminal arriba a la derecha).
2.  **Verificar actualizaciones pendientes:**
    Ejecuta el siguiente comando (cambia `us-east-1` por tu regi贸n si es distinta, ej. `us-east-1` es N. Virginia):
    ```bash
    aws rds describe-pending-maintenance-actions --region us-east-1
    ```
    *Si la respuesta es `[]` (vac铆a), es normal.*

3.  **Verificar actualizaciones de tu recurso espec铆fico:**
    Necesitas el ARN de tu base de datos (lo encuentras en la pesta帽a "Configuration" de tu instancia en la consola).
    ```bash
    aws rds describe-pending-maintenance-actions --resource-identifier <PEGA_AQUI_TU_ARN>
    ```
    *    **CAPTURA 3:** Captura la salida de este comando en la terminal. Si aparece un JSON con "PendingMaintenanceActions", genial. Si sale vac铆o, captura igualmente para demostrar que ejecutaste el comando.

4.  **Aplicar actualizaci贸n v铆a CLI:**
    Si en el paso anterior te salieron actualizaciones pendientes (como `db-upgrade`), puedes aplicarlas con:
    ```bash
    aws rds apply-pending-maintenance-action \
    --resource-identifier <PEGA_AQUI_TU_ARN> \
    --apply-action "db-upgrade" \
    --opt-in-type "immediate" \
    --region us-east-1
    ```
    *    **CAPTURA 4:** Captura la salida del comando o el mensaje de 茅xito.

5.  **Verificaci贸n final:**
    Espera unos minutos y verifica en la consola (o con el comando `describe-db-instances`) que la versi贸n de tu base de datos ha cambiado (ej. de 8.0.40 a 8.0.44/35).
    *    **CAPTURA 5:** Captura de la pesta帽a **Configuration** de tu instancia mostrando la nueva versi贸n del motor ("Engine version").

---

### **Resumen de Capturas (Checklist)**

Para entregar la pr谩ctica correctamente, aseg煤rate de tener estas im谩genes:

1.  **Captura de actualizaciones pendientes:** (Paso II.2) En la consola, secci贸n "Maintenance & backups".
2.  **Captura del despliegue Blue/Green:** (Paso II.10) En la lista de bases de datos, mostrando la jerarqu铆a Blue/Green.
3.  **Captura del error de permisos (Opcional pero recomendada):** (Paso II.14) Al intentar hacer el Switch Over.
4.  **Captura de CLI (JSON):** (Paso III.3) Salida del comando `describe-pending-maintenance-actions`.
5.  **Captura final de versi贸n:** (Paso III.5) Mostrando que la versi贸n del motor de la base de datos ha cambiado tras aplicar los comandos.
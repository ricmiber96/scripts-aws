Aqu√≠ tienes una gu√≠a detallada paso a paso para resolver la **Pr√°ctica 4. R√©plicas de lectura con Aurora**, basada en el documento proporcionado por el IES Juan de Garay.

# Gu√≠a Paso a Paso: Pr√°ctica 4 - R√©plicas y Alta Disponibilidad en Amazon Aurora

Esta pr√°ctica se centra en la alta disponibilidad. Aprender√°s a crear r√©plicas manuales, configurar prioridades de error (Failover) y entender c√≥mo funciona el autoescalado de r√©plicas.

---

### Parte A. Creaci√≥n manual de r√©plicas y Failover

#### 1. Crear el Cl√∫ster Aurora

Primero, necesitas una base de datos principal.

* Ve a la consola de **RDS** y haz clic en **"Crear base de datos"**.
* Selecciona el motor **Amazon Aurora** (puedes elegir compatibilidad con MySQL o PostgreSQL).


* Configura las opciones b√°sicas (nombre del cl√∫ster, usuario, contrase√±a) y cr√©ala. Espera a que est√© en estado "Disponible".

#### 2. Crear las R√©plicas de Lectura

El ejercicio pide crear dos r√©plicas con diferentes prioridades para el failover (recuperaci√≥n ante fallos). Debes investigar qu√© valores corresponden a alta y baja prioridad.

> **Nota T√©cnica sobre Prioridades (Tiers):** En AWS Aurora, la prioridad se define por niveles (Tiers) del **0 al 15**.
> * **Tier 0:** M√°xima prioridad (ser√° el primero en elegirse como nuevo escritor).
> * **Tier 15:** M√≠nima prioridad.
> 
> 

* **Paso 2.1: R√©plica de Alta Prioridad**
1. Selecciona tu cl√∫ster o instancia principal.
2. Ve a **Acciones (Actions)** > **Agregar lector (Add reader)**.


3. En la configuraci√≥n, asigna el nombre: `replica-prioridad-alta`.


4. Busca la secci√≥n **Failover priority** (Prioridad de conmutaci√≥n por error) y selecciona **Tier 0** o **Tier 1**.


5. Crea la instancia.


* **Paso 2.2: R√©plica de Baja Prioridad**
1. Repite el proceso anterior (**Actions** > **Add reader**).
2. Asigna el nombre: `replica-prioridad-baja`.


3. En **Failover priority**, selecciona un valor alto, por ejemplo, **Tier 10** o **Tier 15**.
4. Crea la instancia.



üì∑ **CAPTURA 1 (Verificaci√≥n):**
Una vez creadas, ve al panel principal de "Bases de datos". Toma una captura donde se vean **todas las instancias creadas** (el escritor original y las dos r√©plicas lectoras) con sus nombres y estados.

---

#### 3. Provocar un Failover (Simulaci√≥n de fallo)

Ahora comprobaremos si el sistema promociona a la r√©plica correcta.

1. Selecciona la **instancia escritora (Writer Instance)** actual.
2. Ve a **Acciones (Actions)** > **Conmutaci√≥n por error (Failover)**.


3. Confirma la acci√≥n.
4. Observa qu√© sucede: La instancia "Writer" pasar√° a reiniciarse/modificarse. Durante este proceso, AWS buscar√° la r√©plica con el **Tier m√°s bajo (mayor prioridad)** para convertirla en el nuevo "Writer".
5. Si configuraste bien los Tiers, `replica-prioridad-alta` deber√≠a convertirse en la nueva instancia de escritura (Writer).



üì∑ **CAPTURA 2 (Verificaci√≥n):**
Toma una captura de pantalla del listado de bases de datos donde se vea que `replica-prioridad-alta` ahora tiene el rol de **Writer/Writer Instance** y la antigua principal ha pasado a ser Reader.

---

### Parte B. Autoescalado en Aurora

Esta parte trata sobre c√≥mo configurar el cl√∫ster para que a√±ada r√©plicas autom√°ticamente si la carga de trabajo sube.

#### 1. Iniciar la configuraci√≥n de Autoescalado

1. Selecciona el **cl√∫ster regional** de Aurora (la fila superior que agrupa las instancias).
2. Ve al men√∫ **Acciones (Actions)** > **A√±adir escalado autom√°tico de r√©plica (Add Replica Auto Scaling)**.



#### 2. Definir la Pol√≠tica

Se abrir√° una ventana para configurar la pol√≠tica. Rellena los siguientes datos seg√∫n indica la pr√°ctica:

* 
**Nombre de la pol√≠tica:** Ponle un nombre descriptivo.


* **M√©trica de destino:** Debes elegir qu√© provocar√° el escalado. Las opciones t√≠picas son:
* *Utilizaci√≥n media de CPU de r√©plicas de Aurora* (Average CPU utilization).
* *Promedio de conexiones de r√©plicas de Aurora* (Average connections).
* Elige una y asigna un **Valor de destino** (ej. 50% de CPU).




* **Detalles de capacidad del cl√∫ster:**
* 
**Capacidad m√≠nima:** Define cu√°ntas r√©plicas quieres tener como m√≠nimo (ej. 1).


* 
**Capacidad m√°xima:** Define el l√≠mite m√°ximo de r√©plicas que se pueden crear (ej. 15).





> **Nota:** El documento indica que es probable que **no tengas permisos** para guardar y aplicar finalmente esta pol√≠tica ("Desafortunadamente, no tenemos permiso..."). Sin embargo, el objetivo es llegar hasta la pantalla de configuraci√≥n para ver c√≥mo se hace.
> 
> 

üì∑ **CAPTURA 3 (Verificaci√≥n):**
Toma una captura de la pantalla de configuraci√≥n de la pol√≠tica (antes de darle a "A√±adir") donde se vean los campos que has rellenado: nombre, m√©trica (CPU/Conexiones) y capacidades m√≠nimas/m√°ximas .

---

### Resumen de Entregables (Capturas)

Para considerar la pr√°ctica completa, tu documento debe incluir:

1. **Captura de instancias creadas:** Mostrando el Cluster, el Writer original, `replica-prioridad-alta` y `replica-prioridad-baja`.
2. **Captura post-Failover:** Mostrando que `replica-prioridad-alta` es ahora el **Writer**.
3. **Captura de Autoescalado:** Mostrando el formulario de configuraci√≥n de la pol√≠tica con los valores de CPU/Conexiones y l√≠mites de r√©plicas.